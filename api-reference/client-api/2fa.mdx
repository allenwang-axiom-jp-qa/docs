---
title: '2FA 认证 API'
description: '双因素认证接口，支持 Google Authenticator (TOTP)'
---

# 2FA 认证 API

提供双因素认证功能的 API 接口。

## 支持的认证方式

- **Google Authenticator** (TOTP - Time-based One-Time Password)

## 接口列表

| 接口 | Method | Path | 说明 |
|------|--------|------|------|
| 获取 2FA 密钥 | GET | `/api/v1/client/2fa/secret` | 获取 TOTP 密钥和二维码 |
| 绑定 2FA | POST | `/api/v1/client/2fa/bind` | 验证并绑定 2FA |
| 验证 2FA | POST | `/api/v1/client/2fa/verify` | 验证 2FA 验证码 |
| 解绑 2FA | POST | `/api/v1/client/2fa/unbind` | 解除 2FA 绑定 |

## 使用流程

```mermaid
sequenceDiagram
    participant User as 用户
    participant App as 客户端
    participant Server as 服务器
    participant Auth as Google Authenticator

    User->>App: 开启 2FA
    App->>Server: 请求获取密钥
    Server-->>App: 返回密钥和二维码
    App->>User: 显示二维码
    User->>Auth: 扫描二维码
    Auth-->>User: 显示 6 位验证码
    User->>App: 输入验证码
    App->>Server: 绑定 2FA
    Server-->>App: 绑定成功
```

## 请求示例

### 获取 2FA 密钥

```bash
curl -X GET "https://dev-client.beauty-666.com/api/v1/client/2fa/secret" \
  -H "Authorization: Bearer YOUR_ACCESS_TOKEN"
```

### 响应示例

```json
{
  "code": 0,
  "msg": "success",
  "data": {
    "secret": "JBSWY3DPEHPK3PXP",
    "qr_code": "data:image/png;base64,..."
  }
}
```

### 绑定 2FA

```bash
curl -X POST "https://dev-client.beauty-666.com/api/v1/client/2fa/bind" \
  -H "Authorization: Bearer YOUR_ACCESS_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"code": "123456"}'
```

## 参数说明

### 绑定/验证请求参数

| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| code | string | 是 | 6 位数字验证码 |

## 错误码

| 错误码 | 说明 |
|--------|------|
| INVALID_CODE | 验证码无效 |
| CODE_EXPIRED | 验证码已过期 |
| 2FA_NOT_ENABLED | 2FA 未启用 |
| 2FA_ALREADY_ENABLED | 2FA 已启用 |

<Warning>
2FA 密钥仅在首次获取时显示，请提醒用户妥善保管。如果丢失，需要通过客服重置。
</Warning>
