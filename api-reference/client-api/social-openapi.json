{
  "openapi": "3.0.3",
  "info": {
    "title": "社交互動服務 API",
    "description": "社交互動服務 API 測試集合 - 包含評論、按讚、收藏相關接口",
    "version": "1.0.0"
  },
  "servers": [
    {
      "url": "https://dev-client.beauty-666.com",
      "description": "开发环境"
    }
  ],
  "tags": [
    {
      "name": "1. 評論相關",
      "description": "評論相關的所有接口，包含發表評論、回覆、列表查詢、刪除"
    },
    {
      "name": "2. 按讚相關",
      "description": "按讚相關的所有接口，包含影片按讚、評論按讚和批量檢查"
    },
    {
      "name": "3. 收藏相關",
      "description": "收藏相關的所有接口，包含收藏影片、收藏列表查詢和批量檢查"
    }
  ],
  "paths": {
    "/api/v1/social/comment": {
      "post": {
        "summary": "1.2 發表回覆（巢狀評論）",
        "description": "發表回覆評論（巢狀評論）\n\n參數說明：\n- video_id: 影片 ID（必填）\n- parent_id: 父評論 ID（必填，用於指定回覆哪條評論）\n- content: 評論內容（必填，1-500 字元）\n\n說明：\n- parent_id: 直接回覆的評論 ID\n- root_id: 由系統自動計算，為討論串的根評論 ID",
        "tags": [
          "1. 評論相關"
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "example": {
                  "id": 9,
                  "video_id": 1,
                  "user_id": 38,
                  "parent_id": 4,
                  "root_id": 4,
                  "content": "這是一個回覆評論，同意樓上說的！",
                  "like_count": 0,
                  "reply_count": 0,
                  "user_nickname": "",
                  "user_avatar": "",
                  "created_time": 0,
                  "is_liked": false
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "video_id": {
                    "type": "string"
                  },
                  "parent_id": {
                    "type": "string"
                  },
                  "content": {
                    "type": "string"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/social/comments/{video_id}": {
      "get": {
        "summary": "1.3 獲取影片評論列表",
        "description": "獲取影片的頂層評論列表\n\n排序方式：\n- time: 按時間倒序\n- hot: 按熱度（按讚數）倒序\n\n返回：\n- comments: 評論列表\n- total: 總數\n- has_more: 是否有更多",
        "tags": [
          "1. 評論相關"
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "example": {
                  "comments": [
                    {
                      "id": 8,
                      "video_id": 1,
                      "user_id": 38,
                      "parent_id": 0,
                      "root_id": 0,
                      "content": "這是一個測試評論，影片很精彩！",
                      "like_count": 0,
                      "reply_count": 0,
                      "user_nickname": "",
                      "user_avatar": "",
                      "created_time": 1766524274,
                      "is_liked": false
                    },
                    {
                      "id": 4,
                      "video_id": 1,
                      "user_id": 38,
                      "parent_id": 0,
                      "root_id": 0,
                      "content": "這是一個測試評論，影片很精彩！",
                      "like_count": 1,
                      "reply_count": 2,
                      "user_nickname": "",
                      "user_avatar": "",
                      "created_time": 1766078620,
                      "is_liked": false
                    },
                    {
                      "id": 3,
                      "video_id": 1,
                      "user_id": 38,
                      "parent_id": 0,
                      "root_id": 0,
                      "content": "這是一個測試評論，影片很精彩！",
                      "like_count": 0,
                      "reply_count": 0,
                      "user_nickname": "",
                      "user_avatar": "",
                      "created_time": 1766022366,
                      "is_liked": false
                    },
                    {
                      "id": 2,
                      "video_id": 1,
                      "user_id": 38,
                      "parent_id": 0,
                      "root_id": 0,
                      "content": "這是一個測試評論，影片很精彩！",
                      "like_count": 0,
                      "reply_count": 0,
                      "user_nickname": "",
                      "user_avatar": "",
                      "created_time": 1766022363,
                      "is_liked": false
                    },
                    {
                      "id": 1,
                      "video_id": 1,
                      "user_id": 38,
                      "parent_id": 0,
                      "root_id": 0,
                      "content": "這是一個測試評論，影片很精彩！",
                      "like_count": 0,
                      "reply_count": 0,
                      "user_nickname": "",
                      "user_avatar": "",
                      "created_time": 1766021899,
                      "is_liked": false
                    }
                  ],
                  "total": 5,
                  "has_more": false
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "video_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "page",
            "in": "query",
            "description": "頁碼，默認 1",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "page_size",
            "in": "query",
            "description": "每頁數量，默認 20",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "sort_by",
            "in": "query",
            "description": "排序方式：time（時間排序）或 hot（熱度排序）",
            "schema": {
              "type": "string"
            }
          }
        ]
      }
    },
    "/api/v1/social/replies/{comment_id}": {
      "get": {
        "summary": "1.4 獲取評論回覆列表",
        "description": "獲取某條評論的回覆列表（二級及以下評論）\n\n返回：\n- comments: 回覆列表\n- total: 總數\n- has_more: 是否有更多",
        "tags": [
          "1. 評論相關"
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "example": {
                  "comments": [
                    {
                      "id": 5,
                      "video_id": 1,
                      "user_id": 38,
                      "parent_id": 4,
                      "root_id": 4,
                      "content": "這是一個回覆評論，同意樓上說的！",
                      "like_count": 0,
                      "reply_count": 0,
                      "user_nickname": "",
                      "user_avatar": "",
                      "created_time": 1766078654,
                      "is_liked": false
                    },
                    {
                      "id": 9,
                      "video_id": 1,
                      "user_id": 38,
                      "parent_id": 4,
                      "root_id": 4,
                      "content": "這是一個回覆評論，同意樓上說的！",
                      "like_count": 0,
                      "reply_count": 0,
                      "user_nickname": "",
                      "user_avatar": "",
                      "created_time": 1766524280,
                      "is_liked": false
                    }
                  ],
                  "total": 2,
                  "has_more": false
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "comment_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "page",
            "in": "query",
            "description": "頁碼，默認 1",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "page_size",
            "in": "query",
            "description": "每頁數量，默認 20",
            "schema": {
              "type": "string"
            }
          }
        ]
      }
    },
    "/api/v1/social/comment/{comment_id}": {
      "delete": {
        "summary": "1.5 刪除評論",
        "description": "刪除自己發表的評論\n\n注意：\n- 只能刪除自己發表的評論\n- 刪除為軟刪除（標記狀態為已刪除）",
        "tags": [
          "1. 評論相關"
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "example": {
                  "success": true
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "comment_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ]
      }
    },
    "/api/v1/social/like/video/{video_id}": {
      "post": {
        "summary": "2.1 影片按讚/取消",
        "description": "切換影片按讚狀態（Toggle）\n\n說明：\n- 未按讚 -> 按讚\n- 已按讚 -> 取消按讚\n\n返回：\n- is_liked: 當前按讚狀態\n- like_count: 影片按讚總數",
        "tags": [
          "2. 按讚相關"
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "example": {
                  "is_liked": true,
                  "like_count": 0
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "video_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ]
      }
    },
    "/api/v1/social/like/comment/{comment_id}": {
      "post": {
        "summary": "2.2 評論按讚/取消",
        "description": "切換評論按讚狀態（Toggle）\n\n說明：\n- 未按讚 -> 按讚\n- 已按讚 -> 取消按讚\n\n返回：\n- is_liked: 當前按讚狀態\n- like_count: 評論按讚總數",
        "tags": [
          "2. 按讚相關"
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "example": {
                  "is_liked": true,
                  "like_count": 1
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "comment_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ]
      }
    },
    "/api/v1/social/like/check": {
      "get": {
        "summary": "2.3 批量檢查影片按讚狀態",
        "description": "批量檢查當前用戶是否已對指定影片按讚\n\n參數說明：\n- video_ids: 影片 ID 列表，逗號分隔（必填）\n\n返回：\n- liked_map: 按讚狀態 Map\n  - key: 影片 ID\n  - value: true/false（是否已按讚）\n\n範例響應：\n{\n  \"liked_map\": {\n    \"1\": true,\n    \"2\": false,\n    \"3\": true\n  }\n}",
        "tags": [
          "2. 按讚相關"
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "example": {
                  "liked_map": {
                    "1": true,
                    "2": true
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "video_ids",
            "in": "query",
            "description": "影片 ID 列表，逗號分隔",
            "schema": {
              "type": "string"
            }
          }
        ]
      }
    },
    "/api/v1/social/favorite/{video_id}": {
      "post": {
        "summary": "3.1 收藏/取消收藏影片",
        "description": "切換影片收藏狀態（Toggle）\n\n說明：\n- 未收藏 -> 收藏\n- 已收藏 -> 取消收藏\n\n返回：\n- is_favorited: 當前收藏狀態\n- favorite_count: 影片收藏總數",
        "tags": [
          "3. 收藏相關"
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "example": {
                  "is_favorited": true,
                  "favorite_count": 1
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "video_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ]
      }
    },
    "/api/v1/social/favorite/list": {
      "get": {
        "summary": "3.2 獲取用戶收藏列表",
        "description": "獲取當前用戶的收藏影片列表\n\n返回：\n- videos: 收藏的影片列表\n  - video_id: 影片 ID\n  - title: 影片標題\n  - cover_path: 封面路徑\n  - duration: 時長（秒）\n  - favorited_time: 收藏時間\n- total: 總數\n- has_more: 是否有更多",
        "tags": [
          "3. 收藏相關"
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "example": {
                  "videos": [
                    {
                      "video_id": 2,
                      "title": "",
                      "cover_path": "",
                      "duration": 0,
                      "favorited_time": 1766079099
                    },
                    {
                      "video_id": 1,
                      "title": "",
                      "cover_path": "",
                      "duration": 0,
                      "favorited_time": 1766022320
                    }
                  ],
                  "total": 2,
                  "has_more": false
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "page",
            "in": "query",
            "description": "頁碼，默認 1",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "page_size",
            "in": "query",
            "description": "每頁數量，默認 20",
            "schema": {
              "type": "string"
            }
          }
        ]
      }
    },
    "/api/v1/social/favorite/check": {
      "get": {
        "summary": "3.3 批量檢查影片收藏狀態",
        "description": "批量檢查當前用戶是否已收藏指定影片\n\n參數說明：\n- video_ids: 影片 ID 列表，逗號分隔（必填）\n\n返回：\n- favorited_map: 收藏狀態 Map\n  - key: 影片 ID\n  - value: true/false（是否已收藏）\n\n範例響應：\n{\n  \"favorited_map\": {\n    \"1\": true,\n    \"2\": false,\n    \"3\": true\n  }\n}",
        "tags": [
          "3. 收藏相關"
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "example": {
                  "favorited_map": {
                    "1": true,
                    "2": true
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "video_ids",
            "in": "query",
            "description": "影片 ID 列表，逗號分隔",
            "schema": {
              "type": "string"
            }
          }
        ]
      }
    }
  },
  "components": {
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    },
    "schemas": {
      "BaseResponse": {
        "type": "object",
        "properties": {
          "code": {
            "type": "integer",
            "description": "状态码，0=成功"
          },
          "msg": {
            "type": "string"
          },
          "data": {
            "type": "object"
          }
        }
      }
    }
  }
}